import json

# Input data (replace with actual data)
data = {
  "Meal_Preparation": {
    "M019": 94573,
    "M015": 64012,
    "M016": 16904,
    "M020": 8224,
    "M017": 27303,
    "M021": 4365,
    "M014": 12417,
    "M013": 2860,
    "M022": 2592,
    "M029": 508,
    "M028": 435,
    "D004": 380,
    "M030": 511,
    "M023": 1697,
    "D002": 107,
    "M018": 176,
    "M009": 3681,
    "M008": 838,
    "M010": 1156,
    "M012": 1225,
    "M006": 337,
    "M007": 333,
    "M004": 181,
    "M005": 187,
    "M026": 830,
    "M027": 392,
    "M025": 201,
    "M011": 162,
    "D001": 31,
    "M031": 74,
    "M024": 7729,
    "M003": 14,
    "M002": 2,
    "M001": 24
  },
  "Housekeeping": {
    "M021": 650,
    "M020": 1321,
    "M013": 436,
    "M009": 576,
    "M012": 238,
    "M018": 451,
    "M014": 731,
    "M017": 196,
    "M008": 396,
    "M007": 1048,
    "M003": 114,
    "M006": 308,
    "M019": 578,
    "M015": 356,
    "M016": 80,
    "M027": 58,
    "M005": 462,
    "M026": 96,
    "M004": 256,
    "M010": 295,
    "M022": 275,
    "M001": 166,
    "M023": 124,
    "M024": 522,
    "M028": 66,
    "M011": 66,
    "D001": 14,
    "M029": 76,
    "M025": 22,
    "M002": 14,
    "M030": 16,
    "D004": 8,
    "D002": 2
  },
  "Eating": {
    "M013": 271,
    "M020": 1081,
    "M019": 692,
    "M018": 820,
    "M021": 255,
    "M009": 184,
    "M006": 14,
    "M008": 37,
    "M017": 283,
    "M015": 380,
    "M010": 76,
    "M004": 4,
    "M007": 10,
    "M012": 55,
    "M028": 23,
    "M016": 121,
    "M024": 813,
    "M022": 132,
    "M023": 78,
    "M003": 2,
    "M011": 58,
    "M029": 44,
    "M026": 6,
    "M027": 2,
    "M005": 6,
    "D004": 12,
    "M030": 12,
    "D002": 4,
    "D001": 25
  },
  "Enter_Home": {
    "M030": 761,
    "M029": 199,
    "M016": 2,
    "M022": 82,
    "M021": 20,
    "M028": 40,
    "M014": 14,
    "M023": 20,
    "M018": 2,
    "M019": 2,
    "M024": 4
  },
  "Relax": {
    "M020": 23204,
    "M013": 31314,
    "M010": 11633,
    "M012": 6308,
    "M009": 795,
    "M026": 1612,
    "M021": 2278,
    "M014": 4120,
    "M024": 17245,
    "M023": 1520,
    "M029": 483,
    "M022": 1784,
    "M018": 2207,
    "M019": 2687,
    "M016": 867,
    "M015": 1733,
    "M017": 833,
    "M008": 713,
    "M006": 378,
    "M007": 596,
    "M005": 334,
    "M004": 176,
    "M027": 837,
    "M028": 493,
    "M011": 111,
    "M025": 416,
    "M030": 367,
    "M003": 80,
    "M002": 99,
    "D004": 265,
    "M001": 149,
    "D001": 16,
    "M031": 30,
    "D002": 17
  },
  "Work": {
    "M022": 149,
    "M028": 348,
    "M027": 4290,
    "M023": 27,
    "M025": 571,
    "M021": 17,
    "M018": 5,
    "M019": 3,
    "D004": 15,
    "M030": 20,
    "M004": 3,
    "M007": 10,
    "M029": 26,
    "M005": 4,
    "M020": 13,
    "M013": 6,
    "M014": 4,
    "M001": 2,
    "M024": 579,
    "M015": 4
  },
  "Respirate": {
    "M022": 6,
    "M028": 7,
    "M027": 94,
    "M025": 6,
    "M026": 36
  },
  "Wash_Dishes": {
    "M020": 203,
    "M014": 383,
    "M017": 876,
    "M019": 3663,
    "M015": 2959,
    "M021": 87,
    "M008": 12,
    "M016": 406,
    "M013": 46,
    "M022": 38,
    "M023": 6,
    "M028": 23,
    "M026": 26,
    "M006": 6,
    "M007": 5,
    "M005": 2,
    "M004": 3,
    "D004": 4,
    "M030": 8,
    "M029": 19,
    "M027": 16,
    "M025": 14,
    "M012": 8,
    "M024": 94,
    "M010": 2,
    "M018": 14,
    "M009": 22,
    "M003": 2
  },
  "Leave_Home": {
    "M030": 491,
    "M028": 26,
    "M023": 10,
    "M022": 59,
    "M029": 374,
    "M026": 4,
    "M027": 2,
    "M025": 2,
    "M019": 4,
    "M021": 28,
    "M020": 15,
    "M018": 6,
    "M014": 21,
    "M013": 4,
    "M012": 4,
    "M008": 4,
    "M006": 2
  },
  "Bed_to_Toilet": {
    "M005": 218,
    "M007": 393
  },
  "Sleeping": {
    "M002": 3757,
    "M007": 1994,
    "M005": 118,
    "M016": 40,
    "M006": 153,
    "M022": 71,
    "M030": 32,
    "M001": 71,
    "M004": 44,
    "M023": 133,
    "M010": 34,
    "M026": 32,
    "M015": 30,
    "M017": 44,
    "M028": 36,
    "M009": 42,
    "M008": 56,
    "M014": 38,
    "M018": 52,
    "M025": 32,
    "M029": 58,
    "M011": 30,
    "M012": 30,
    "M031": 30,
    "M013": 46,
    "M024": 1344,
    "M021": 52,
    "M027": 32,
    "M019": 44,
    "M020": 71,
    "D004": 24,
    "D002": 6,
    "D001": 6
  }
}

# Function to apply 5% threshold filtering
def filter_sensors(data, threshold=0.05):
    filtered_data = {}
    for activity, sensors in data.items():
        total_activations = sum(sensors.values())
        threshold_value = threshold * total_activations
        relevant_sensors = {sensor: count for sensor, count in sensors.items() if count >= threshold_value}
        filtered_data[activity] = relevant_sensors
    return filtered_data

# Apply filtering
filtered_sensors = filter_sensors(data, threshold=0.05)


with open("avgEventCountForEachActivity.json", "w") as file:
    json.dumps(filtered_sensors,file, indent=4)